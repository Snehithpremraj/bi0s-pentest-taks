#this is a test file
from Crypto. Cipher import AES
import hashlib
import hashlib
import hmac


msg=input('enter the message : ')
key=b'dattebayomhaaotf'
iv=b'shhhdifnivrnfhrf'

ln=len(msg)

def pad(msg):
	block_size=16
	p=(block_size-len(msg))%block_size
	pd_str=p * ' '
	print(pd_str)
	return msg+pd_str
	
def unpad(msgg):
	return msgg.rstrip()
	
aes=AES.new(key,AES.MODE_CBC,iv)
pad_msg=pad(msg)
print(pad_msg)
ecp=aes.encrypt(pad_msg)
adec=AES.new(key,AES.MODE_CBC,iv)
dcp=adec.decrypt(ecp)
print(dcp)
upad_msg=unpad(dcp)

ha_sh=hmac.new(key,msg,hashlib.sha512)
print(ha_sh)
