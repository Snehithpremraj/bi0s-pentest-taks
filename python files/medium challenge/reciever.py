import socket
import Crypto
import hmac
import hashlib
import sys
from Crypto.Cipher import AES
key=b'dattebayomhaaotf'
iv=b'shhhdifnivrnfhrf'
aes=AES.new(key,AES.MODE_CBC,iv)
port=4030
sock=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
sock.connect(('',port))

message=sock.recv(1000)
h_sh=str(sock.recv(1000))
def unpad(message):
	m=message.rstrip(' * ')
	return m

u_m=aes.decrypt(message)
r_m=unpad(u_m)
hs=hmac.new(key,r_m,hashlib.sha512)
h_s=hs.hexdigest()
if h_sh==h_s :
	print(r_m)
sock.close()